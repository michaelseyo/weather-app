(()=>{"use strict";function e(){return document.querySelector("#metric").classList.contains("active")?"metric":"imperial"}function t(e){return Math.round(1*e)/1}function n(e){return e.charAt(0).toUpperCase()+e.slice(1)}function r(e,t){return function(e){let t;t=e.replace("GMT",""),t=t.replace(",","");const n=t.split(" "),r=function(e){const t=e.split(":");return("12"!=t[0]?t[0]%12:12)+":"+t[1]+(t[0]>=12?"pm":"am")}(n[4]);return n[4]=r,t=n.join(" "),t}(new Date(1e3*t+1e3*e).toUTCString())}function c(e){const t=e.split(" ");return"0:00am"==t[4]?"12:00am":t[4]}let i=null;function o(o){const a=e();console.log(o.data);const d=o.location,s=o.data.current,m=o.data.hourly,p=o.data.daily,h=o.data.timezone_offset;!function(e,o,l,a){const d=document.querySelector(".current");let s,m,p,h,y,C,x,$,g,S,f,q,T,w,E,W;null==i?(s=document.createElement("ul"),s.id="currWeather-ul",m=document.createElement("li"),m.id="currTime-li",p=document.createElement("li"),p.id="currLocationText-li",h=document.createElement("img"),h.id="currWeather-img",y=document.createElement("li"),y.id="currWeatherDesc-li",C=document.createElement("li"),C.id="currTempText-li",$=document.createElement("li"),$.id="currFeelsLike-li",x=document.createElement("ul"),x.id="currWeatherDetails-ul",g=document.createElement("li"),g.id="currHumidity-li",S=document.createElement("li"),S.id="currPressure-li",f=document.createElement("li"),f.id="currSunrise-li",q=new Image,q.id="currSunrise-img",T=document.createElement("li"),T.id="currSunset-li",w=new Image,w.id="currSunset-img",E=document.createElement("li"),E.id="currWindspeed-li",W=new Image,W.id="currWind-img"):(s=document.querySelector("#currWeather-ul"),x=document.querySelector("#currWeatherDetails-ul"),m=document.querySelector("#currTime-li"),p=document.querySelector("#currLocationText-li"),h=document.querySelector("#currWeather-img"),y=document.querySelector("#currWeatherDesc-li"),C=document.querySelector("#currTempText-li"),$=document.querySelector("#currFeelsLike-li"),x=document.querySelector("#currWeatherDetails-ul"),g=document.querySelector("#currHumidity-li"),S=document.querySelector("#currPressure-li"),f=document.querySelector("#currSunrise-li"),q=document.querySelector("#currSunrise-img"),T=document.querySelector("#currSunset-li"),w=document.querySelector("#currSunset-img"),E=document.querySelector("#currWindspeed-li"),W=document.querySelector("#currWind-img"));const M=r(o,e.dt);m.textContent=M,p.textContent=function(e){const t=e.split(" ");for(let e=0;e<t.length;e++)t[e]=t[e].charAt(0).toUpperCase()+t[e].slice(1);return t.join(" ")}(l),h.src=u(M,e.weather[0].description),y.textContent=n(e.weather[0].description),C.textContent="metric"==a?t(e.temp)+"°C":t(e.temp)+"°F";const k="metric"==a?t(e.feels_like)+"°C":t(e.feels_like)+"°F";$.textContent=`Feels like: ${k}`,g.textContent=`Humidity: ${e.humidity}%`,S.textContent=`Pressure: ${e.pressure}hPa`,f.textContent=c(r(o,e.sunrise)),q.src="./images/sunrise-img.png",T.textContent=c(r(o,e.sunset)),w.src="./images/sunset-img.png",E.textContent=`Wind speed: ${e.wind_speed}m/s`,W.src="./images/wind-img.png",s.appendChild(m),s.appendChild(p),s.appendChild(h),s.appendChild(y),s.appendChild(C),s.appendChild($),d.appendChild(s),x.appendChild(g),x.appendChild(S),x.appendChild(q),x.appendChild(f),x.appendChild(w),x.appendChild(T),x.appendChild(W),x.appendChild(E),d.appendChild(x)}(s,h,d,a);for(let e=1;e<25;e++)l(m[e],h,e,a,"hour");for(let e=1;e<8;e++)l(p[e],h,e,a,"day");i=d}function l(e,o,l,a,d){let s,m,p,h,y,C,x,$;s="hour"==d?document.querySelector(".hourly"):document.querySelector(".daily"),null==i?(m=document.createElement("ul"),m.id=`${d}${l}Weather-ul`,p=document.createElement("li"),p.id=`${d}${l}Time-li`,h=document.createElement("img"),h.id=`${d}${l}Weather-img`,y=document.createElement("li"),y.id=`${d}${l}WeatherDesc-li`,"hour"==d?(C=document.createElement("li"),C.id=`${d}${l}TempText-li`):(x=document.createElement("li"),x.id=`${d}${l}MinTempText-li`,$=document.createElement("li"),$.id=`${d}${l}MaxTempText-li`)):(m=document.querySelector(`#${d}${l}Weather-ul`),p=document.querySelector(`#${d}${l}Time-li`),h=document.querySelector(`#${d}${l}Weather-img`),y=document.querySelector(`#${d}${l}WeatherDesc-li`),"hour"==d?C=document.querySelector(`#${d}${l}TempText-li`):(x=document.querySelector(`#${d}${l}MinTempText-li`),$=document.querySelector(`#${d}${l}MaxTempText-li`)));const g=r(o,e.dt);if(h.src=u(g,e.weather[0].description,d),y.textContent=n(e.weather[0].description),"hour"==d){const n=c(g);p.textContent=n,C.textContent="metric"==a?t(e.temp)+"°C":t(e.temp)+"°F"}else{const n=g.split(" ").slice(0,3).join(" ");p.textContent=n,x.textContent="metric"==a?"Min: "+t(e.temp.min)+"°C":"Min: "+t(e.temp.min)+"°F",$.textContent="metric"==a?"Max: "+t(e.temp.max)+"°C":"Max: "+t(e.temp.max)+"°F"}m.appendChild(p),m.appendChild(h),m.appendChild(y),"hour"==d?m.appendChild(C):(m.appendChild(x),m.appendChild($)),s.appendChild(m)}function u(e,t,n){const r=t.toLowerCase(),c="hour"==n?function(e){const t=e.split(" ")[4],n=t.split(":")[0],r=t.split(":")[1].slice(2);let c;return c=n>=7&&"pm"==r||n<=6&&"am"==r?"night":"day",c}(e):"day";let i;return r.includes("thunderstorm")?i="11d":["drizzle","shower rain"].includes(r)?i="09d":r.includes("rain")&&"freezing rain"!=r&&!r.includes("snow")?i="day"==c?"10d":"10n":r.includes("freezing rain")||r.includes("snow")||r.includes("sleet")?i="13d":["mist","smoke","haze","sand","fog","dust","volcanic ash","squails","tornado"].includes(r)?i="50d":r.includes("clear sky")?i="day"==c?"01d":"01n":"few clouds"==r?i="day"==c?"02d":"02n":"scattered clouds"==r?i="day"==c?"03d":"03n":["broken clouds","overcast clouds"].includes(r)&&(i="day"==c?"04d":"04n"),`http://openweathermap.org/img/wn/${i}@2x.png`}function a(e,n){const r=function(e,n){const r=e.textContent.match(/\d+/)[0];let c;return c="metric"==n?function(e){return t((e-32)/1.8)}(r):function(e){return t(1.8*e+32)}(r),c}(e,n),c="metric"==n?r+"°C":r+"°F";e.textContent.includes("Min")?e.textContent=`Min: ${c}`:e.textContent.includes("Max")?e.textContent=`Max: ${c}`:e.textContent=c}const d="36b3c347e210c2acb6e17f82bab1563c",s=async function(t){t.preventDefault();try{const t=e(),n=await async function(e){try{const e=document.querySelector("#search-bar").value;console.log("searched location: "+e);const t=await fetch(`https://api.openweathermap.org/data/2.5/weather?q=${e}&exclude=minutely&appid=${d}`),n=await t.json();return console.log(n),{coord:n.coord,location:e}}catch(e){console.log(e)}}(),r=n.coord,c=n.location,i=await fetch(`https://api.openweathermap.org/data/2.5/onecall?lat=${r.lat}&lon=${r.lon}&units=${t}&exclude=minutely&appid=${d}`);return{data:await i.json(),location:c}}catch{console.log(error)}},m="36b3c347e210c2acb6e17f82bab1563c";document.onload=async function(){try{const t=e(),n=await fetch(`https://api.openweathermap.org/data/2.5/weather?q=Singapore&exclude=minutes&appid=${m}`),r=(await n.json()).coord,c=await fetch(`https://api.openweathermap.org/data/2.5/onecall?lat=${r.lat}&lon=${r.lon}&units=${t}&exclude=minutes&appid=${m}`);o({data:await c.json(),location:"Singapore"})}catch(e){console.log(e)}}(),function(){const t=document.querySelector("#search-icon");e(),t.addEventListener("click",(async e=>{o(await s(e))})),t.addEventListener("keyup",(async e=>{"Enter"==e.key&&o(await s(e))}))}(),function(){const t=document.querySelectorAll("button");let n=document.querySelector("#metric");t.forEach((t=>t.addEventListener("click",(t=>{t.preventDefault(),t.currentTarget.classList.add("active"),n!=t.currentTarget&&(n.classList.remove("active"),n=t.currentTarget,function(e){a(document.querySelector("#currTempText-li"),e),a(document.querySelector("#currFeelsLike-li"),e);for(let t=1;t<25;t++)a(document.querySelector(`#hour${t}TempText-li`),e);for(let t=1;t<8;t++)a(document.querySelector(`#day${t}MinTempText-li`),e),a(document.querySelector(`#day${t}MaxTempText-li`),e)}(e()))}))))}()})();